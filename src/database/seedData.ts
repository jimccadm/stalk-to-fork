import { getDatabase } from './database';
import { DeerStalkingRecord } from '../types';
import { importCSVData } from './csvImporter';

// Raw data from the spreadsheet
const rawData = `30-Jul-24	MUNTJAC	F	DOE	6	600 393	PUNCH BOWL	PM
02-Aug-24						TARRINGTON COMMON	PM
03-Aug-24	ROE	M	BUCK	18		PLANTATION	AM
03-Aug-24						DEVERAUX PONDS	PM
04-Aug-24	ROE	M	BUCK	18			AM
04-Aug-24	FOX	F	VIXEN		620 401	TARRINGTON COMMON	PM
04-Aug-24	FALLOW	M	PRICKET	27	614 400	SWILLOW WOOD	PM
04-Aug-24	FALLOW	M	PRICKET	27	614 400	SWILLOW WOOD	PM
07-Aug-24	FALLOW	M	PRICKET	35	609 391	PLANTATION	AM
07-Aug-24	FALLOW	M	PRICKET	36	609 391	PLANTATION	AM
07-Aug-24	ROE	M	BUCK		612 391	HIGHNAM FARM	PM
07-Aug-24	FOX				611 397	HIGHNAM FARM	PM
12-Aug-24						PLANTATION	PM
14-Aug-24	MUNTJAC	M	BUCK	8.5	615 380	DEVERAUX PONDS	PM
14-Aug-24	MUNTJAC	M	BUCK	5	622 367	DEVERAUX PONDS	PM
15-Aug-24						TARRINGTON COMMON	PM
15-Aug-24	FALLOW	M	PRICKET	32	585 397	DORMINGTON	PM
15-Aug-24	FALLOW	M	PRICKET	32	586 393	DORMINGTON	PM
18-Aug-24	FALLOW	M	PRICKET	36	615 376	DEVERAUX PONDS	PM
18-Aug-24	MUNTJAC	F	DOE	3	621 371	DEVERAUX PONDS	PM
18-Aug-24	MUNTJAC	M	BUCK	8.5	618 373	DEVERAUX PONDS	PM
18-Aug-24	MUNTJAC	M	BUCK	9	618 387	COSSINGTON	PM
18-Aug-24	FALLOW	M	PRICKET	31	621 383	COSSINGTON	PM
18-Aug-24						JURASSIC RIDGE	PM
20-Aug-24	MUNTJAC	F	DOE		583 389	BACKBURY HILL	AM
20-Aug-24	MUNTJAC	M	BUCK		597 389	OLD QUARRY	AM
20-Aug-24						PLANTATION	PM
21-Aug-24						COSSINGTON	PM
23-Aug-24	FALLOW	M	PRICKET	37	617 394	TARRINGTON COMMON	PM
26-Aug-24						JURASSIC RIDGE	AM
26-Aug-24						LEANING TOWER 	PM
27-Aug-24						TARRINGTON COMMON	PM
01-Sep-24	MUNTJAC	M	BUCK	8	610 393	TARRINGTON COMMON	AM
01-Sep-24	MUNTJAC	F	DOE	9		JURASSIC RIDGE	AM
01-Sep-24	FALLOW	M	PRICKET	38		JURASSIC RIDGE	AM
01-Sep-24	FALLOW	M	PRICKET	33		JURASSIC RIDGE	AM
06-Sep-24						JURASSIC RIDGE	PM
14-Sep-24						PLANTATION	PM
14-Sep-24						TARRINGTON COMMON	PM
14-Sep-24						TARRINGTON COMMON	PM
14-Sep-24	FALLOW	M	PRICKET	39	620 371	DEVERAUX PONDS	PM
22-Sep-24	FALLOW	M	BUCK	74	604 383	JURASSIC RIDGE	PM
22-Sep-24						DEVERAUX PONDS	PM
24-Sep-24						BUNKERS HILL	PM
24-Sep-24	MUNTJAC	M	BUCK	8	592 387	FRITH WOODS	PM
24-Sep-24	FALLOW	M	BUCK	54	591 391	FRITH WOODS	PM
24-Sep-24						THE SLIP	PM
24-Sep-24						JURASSIC RIDGE	PM
25-Sep-24	FALLOW	M	PRICKET	43	615 377	PARK FARM FIELD	PM
25-Sep-24	FOX						PM
27-Sep-24							PM
28-Sep-24	MUNTJAC	M	BUCK	9	622 367	DEVERAUX PONDS	PM
29-Sep-24						JURASSIC RIDGE	AM
29-Sep-24						JURASSIC RIDGE	AM
29-Sep-24	FALLOW	M	PRICKET	37	601 391	PLANTATION	PM
02-Oct-24						DEVERAUX PONDS	PM
03-Oct-24	FALLOW	M	PRICKET	45	603 389	PLANTATION	PM
04-Oct-24	FALLOW	M	SORREL	55	615 376	DEVERAUX PONDS	AM
04-Oct-24	MUNTJAC	M	BUCK	10	623 369	DEVERAUX PONDS	AM
04-Oct-24	FALLOW	M	PRICKET	36	585 393	DORMINGTON	PM
04-Oct-24	FALLOW	F	DOE	29	582 388	DORMINGTON	PM
04-Oct-24	FALLOW	M	PRICKET	43	586 391	DORMINGTON	PM
05-Oct-24	FALLOW	M	SORREL	56	603 393	PLANTATION	AM
05-Oct	FALLOW	F	FAWN	10	601 386	PLANTATION	AM
05-Oct-24	FALLOW	M	PRICKET	37	600 386	PLANTATION	AM
05-Oct-24	MUNTJAC	M	BUCK	5	599 395	PLANTATION	AM
06-Oct-24						PLANTATION	PM
08-Oct-24	MUNTJAC	M	BUCK	9			PM
08-Oct-24	FALLOW	M	BUCK	61	598 404	UPPER LAY WOODS	PM
08-Oct-24							PM
10-Oct-24	FALLOW	M	PRICKET	36	596 389	FRITH WOODS	PM
10-Oct-24							PM
10-Oct-24							PM
11-Oct-24							PM
11-Oct-24	FALLOW	M	PRICKET	37	602 387	THE CASTLE	PM
12-Oct-24							PM
12-Oct-24	MUNTJAC	M	BUCK	9	599 393	OLD QUARRY	PM
13-Oct-24							AM
13-Oct-24							AM
17-Oct-24							PM
18-Oct-24							PM
19-Oct-24	MUNTJAC	M	BUCK	8	601 388	DORMINGTON WOODS	AM
19-Oct-24	MUNTJAC	M	BUCK	11	600 394	DORMINGTON WOODS	AM
19-Oct-24	FALLOW	M	PRICKET	36	619 386	COSSINGTON	PM
19-Oct-24	FALLOW	M	PRICKET	33	618 396	TARRINGTON COMMON	PM
20-Oct-24						UPPER DORMINGTON	PM
21-Oct-24	FALLOW	M	PRICKET	32	599 392	OLD QUARRY	AM
21-Oct-24	FOX	M	DOG		599 394	OLD QUARRY	AM
22-Oct-24							AM
22-Oct-24							PM
22-Oct-24							PM
24-Oct-24						JURASSIC RIDGE	PM
24-Oct-24						PARK FARM FIELD	PM
25-Oct-24	FOX	M	DOG			SILO	PM
26-Oct-24						PRIORS WOOD	AM
26-Oct-24	FALLOW	M	SORREL	53	599 360	PLANTATION	PM
27-Oct-24						DEVERAUX PONDS	AM
27-Oct-24	FALLOW	M	PRICKET	36	602 393	PLANTATION	AM
27-Oct-24	FALLOW	M	BUCK	50	603 393	PLANTATION	AM
28-Oct-24	FALLOW	M	SORREL	47.5	604 395	PLANTATION	AM
29-Oct-24	FALLOW	M	PRICKET	37		SPOOKY COTTAGE	PM
01-Nov-24						JURASSIC RIDGE	AM
01-Nov-24	FALLOW	F	DOE	31.5	604 407	STOKE EDITH CHURCH	PM
02-Nov-24	FALLOW	F	DOE	29	618 369	DEVERAUX PONDS	AM
04-Nov-24	FALLOW	F	DOE	35	602 387	LEANING TOWER	PM
04-Nov-24	FALLOW	F	FAWN	17	602 385	LEANING TOWER	PM
04-Nov-24	FALLOW	F	DOE	34	606 384	PRIORS WOOD SEAT	PM
04-Nov-24	MUNTJAC	M	BUCK	8	606 384	PRIORS WOOD SEAT	PM
07-Nov-24	FALLOW	F	DOE	34	617 395	TARRINGTON COMMON	PM
08-Nov-24	FALLOW	M	PRICKET	37	598 395	PERTON GATE	AM
08-Nov-24	ROE	F	DOE	17	609 390	SHEEPCOTE HILL	AM
08-Nov-24	FALLOW	F	DOE	31	602 388	PLANTATION	PM
08-Nov-24	FALLOW	F	FAWN	19	602 388	PLANTATION	PM
08-Nov-24	MUNTJAC	M	BUCK	8	596 394	KEEPERS COTTAGE	PM
01-Nov-24	ROE	F	DOE	12	608 388	JURASSIC RIDGE	AM
09-Nov-24	MUNTJAC	M	BUCK	11	619 388	COSSINGTON	AM
11-Nov-24	FALLOW	F	DOE	38	605 385	PLANTATION	AM
11-Nov-24	FALLOW	F	FAWN	11	604 385	PLANTATION	AM
11-Nov-24	MUNTJAC	M	BUCK	9	602 387	LEANING TOWER	AM
11-Nov-24	MUNTJAC	M	BUCK	5	602 387	LEANING TOWER	AM
11-Nov-24	FALLOW	F	DOE	37	588 394	PROSPECT FARM	PM
11-Nov-24	FALLOW	M	FAWN	20	588 394	PROSPECT FARM	PM
11-Nov-24	FALLOW	M	BUCK	46	588 394	PROSPECT FARM	PM
12-Nov-24	FALLOW	F	DOE	31	591 393	TOWER HILL	PM
12-Nov-24	FALLOW	F	DOE	30	582 391	RICHARD ORCHARD	PM
12-Nov-24	FALLOW	F	DOE	29	582 391	RICHARD ORCHARD	PM
12-Nov-24	FALLOW	F	FAWN	15		DORMINGTON FIELDS	PM
13-Nov-24	FALLOW	F	DOE	29	590 391	TOWER HILL	PM
13-Nov-24	FALLOW	M	FAWN	22	590 391	WOOTON	PM
13-Nov-24	FALLOW	F	DOE	38	603 384	PLANTATION	PM
13-Nov-24	FALLOW	F	FAWN	19	605 383	PLANTATION	PM
13-Nov-24	MUNTJAC	F	DOE	5	604 384	PLANTATION	PM
14-Nov-24	FALLOW	F	DOE	31	591 391	TOWER HILL	PM
14-Nov-24						DORMINGTON FIELDS	PM
15-Nov-24	MUNTJAC	F	DOE	7	583 389	BACKBURY HILL	PM
16-Nov-24	FALLOW	F	DOE	28	599 386	CHECKLEY COMMON	PM
16-Nov-24						TARRINGTON COMMON	PM
16-Nov-24	FALLOW	F	FAWN	18	619 370	DEVERAUX PONDS	PM
16-Nov-24	FALLOW	F	DOE	30	583 389	PROSPECT FARM	PM
16-Nov-24	MUNTJAC	M	BUCK	9		NEIGHBROOKS	PM
17-Nov-24	MUNTJAC	F 	DOE	8	609 382	DEVERAUX PONDS	PM
17-Nov-24	FALLOW	F	DOE	36	621 366	DEVERAUX PONDS	AM
17-Nov-24	FALLOW	F	DOE	30	623 373	DEVERAUX PONDS	AM
17-Nov-24	FALLOW	F	FAWN	15	616 375	DEVERAUX PONDS	AM
19-Nov-24	FALLOW	M	PRICKET	31	606 407	STOKE EDITH CHURCH	PM
21-Nov-24	FALLOW	F	FAWN	17	621 366	DEVERAUX PONDS	PM
21-Nov-24						TOWER HILL	PM
23-Nov-24	MUNTJAC	M	BUCK	8	614 393	DEVERAUX PONDS	PM
23-Nov-24						TOWER HILL	PM
23-Nov-24	MUNTJAC	M	BUCK	4	605 385	PLANTATION	PM
23-Nov-24	FALLOW	F	FAWN	14.5	625 369	DEVERAUX PONDS	PM
24-Nov-24	FALLOW	M	FAWN	20	607 401	UPPER LAY WOODS	AM
24-Nov-24	FALLOW	F	DOE	37	607 401	UPPER LAY WOODS	AM
24-Nov-24	FALLOW	F	DOE	34	607 401	UPPER LAY WOODS	AM
24-Nov-24	FALLOW	F	DOE	34	607 401	UPPER LAY WOODS	AM
24-Nov-24	FALLOW	F	DOE	32	607 401	UPPER LAY WOODS	AM
24-Nov-24	MUNTJAC	M	BUCK	7.5	601 392	PLANTATION	AM
24-Nov-24	MUNTJAC	M	BUCK	5	612 397	DEVERAUX PONDS	AM
26-Nov-24	MUNTJAC	F	DOE	5	599 392	OLD QUARRY	PM
26-Nov-24	FALLOW	F	FAWN	21	601 391	PUNCH BOWL	PM
27-Nov-24	FALLOW	F	DOE	35	589 392	PROSPECT FARM	AM
29-Nov-24	FALLOW	F	FAWN	16	620 384	COSSINGTON	AM
29-Nov-24	FALLOW	M	FAWN	21	620 384	COSSINGTON	AM
29-Nov-24	FALLOW	F	DOE	28	626 373 	DEVERAUX PONDS	AM
30-Nov-24	FALLOW	F	DOE	34	598 388	PLANTATION	AM
30-Nov-24	FALLOW	F	DOE	32	598 388	PLANTATION	AM
04-Dec-24	FALLOW	M	PRICKET	38	601 393	SPOOKY COTTAGE	PM
06-Dec-24	FALLOW	F	DOE	30.5	589 391	PROSPECT FARM	PM
06-Dec-24	FALLOW	M	FAWN	15	589 391	PROSPECT FARM	PM
07-Dec-24						DEVERAUX PONDS	AM
07-Dec-24						KEEPERS COTTAGE	AM
10-Dec-24							PM
14-Dec-24	FALLOW	F	DOE	33	596 392	OLD QUARRY	AM
14-Dec-24						PROSPECT FARM	AM
15-Dec-24	FALLOW	F	FAWN	20	606 383	LEANING TOWER	PM
15-Dec-24	FALLOW	M	PRICKET	37	606 392	PLANTATION	PM
15-Dec-24	FALLOW	F	DOE	32	617 396	TARRINGTON COMMON	PM
16-Dec-24	FALLOW	M	FAWN	21	583 390	THE ORCHARDS	AM
16-Dec-24	FALLOW	F 	DOE	40	618 374	PARK FARM FIELD	AM
16-Dec-24	MUNTJAC	M	BUCK	8	623 366	DEVERAUX PONDS	AM
17-Dec-24							PM
18-Dec-24	FALLOW	F	DOE	24.5	590 391	PROSPECT FARM	PM
19-Dec-24	MUNTJAC	M	BUCK	10	605 397	COCKSHOOT	PM
20-Dec-24	FALLOW	F	DOE	35	618 395	TARRINGTON COMMON	PM
20-Dec-24	FALLOW	F	FAWN	15	618 395	TARRINGTON COMMON	PM
20-Dec-24	MUNTJAC	M	BUCK	11.5	618 395	TARRINGTON COMMON	PM
22-Dec-24						DEVERAUX PONDS	PM
21-Dec-24						PROSPECT FARM	AM
27-Dec-24	MUNTJAC	M	BUCK	12	307 643	DEVERAUX PONDS	PM
28-Dec-24	MUNTJAC	M	BUCK	5	605 385	PLANTATION	PM
28-Dec-24	FALLOW	M	FAWN	24	600 387	PLANTATION	PM
29-Dec-24	FALLOW	F	FAWN	20	620 384	NEIGHBROOKS	AM
29-Dec-24	FALLOW	M	SORREL	40	622 377	DEVERAUX PONDS	AM
29-Dec-24	FALLOW	M	FAWN	25	620 386	DEVERAUX PONDS	PM
29-Dec-24	FALLOW	M	FAWN	20	608 387	PLANTATION	PM
29-Dec-24	FALLOW	M	PRICKET	38	618 395	TARRINGTON COMMON	PM
29-Dec-24	FALLOW	M	FAWN	22	604 387	PLANTATION	PM
29-Dec-24	FALLOW	F	FAWN	19	603 395	PLANTATION	PM
29-Dec-24	FALLOW	F	DOE	31	587 393	PROSPECT FARM	PM
30-Dec-24	FALLOW	F	FAWN	19	589 390	TOWER HILL	AM
30-Dec-24	FOX	M	DOG		621 385	DEVERAUX PONDS	AM
30-Dec-24	FALLOW	F	DOE	20	603 385	PRIORS WOOD	AM
30-Dec-24	MUNTJAC	M	BUCK	6	606 383	LEANING TOWER	PM
30-Dec-24	FOX	M	DOG		606 383	LEANING TOWER	PM
30-Dec-24						COSSINGTON	PM
30-Dec-24						DEVERAUX PONDS	PM
30-Dec-24						PLANTATION	PM
30-Dec-24						DORMINGTON WOODS	PM
31-Dec-24	FALLOW	F	FAWN	21.5	618 374	PARK FARM FIELD	AM
03-Jan-25						DORMINGTON WOODS	AM
04-Jan-25	FALLOW	F	DOE	29	602 395	PLANTATION	PM
04-Jan-25	FALLOW	F	DOE	26	602 395	PLANTATION	PM
05-Jan-25	FALLOW	F	DOE	36	601 394	STALAG HIGHSEAT	PM
05-Jan-25							PM
12-Jan-25	FALLOW	M	FAWN	23.5	600 393	PUNCH BOWL	AM
12-Jan-25	MUNTJAC	M	BUCK	7.5	600 393	PUNCH BOWL	AM
12-Jan-25	MUNTJAC	F	DOE	7.5	600 393	PUNCH BOWL	AM
12-Jan-25	MUNTJAC	M	FAWN	4	601 387	PRIORS WOOD	AM
12-Jan-25	MUNTJAC	M	BUCK	6	619 370	DEVERAUX PONDS	AM
15-Jan-25	FALLOW	M	FAWN	24	618 374	PARK FARM FIELD	PM
15-Jan-25	FALLOW	F	FAWN	18	618 374	PARK FARM FIELD	PM
15-Jan-25	MUNTJAC	F	DOE	7	618 374	PARK FARM FIELD	PM
18-Jan-25	MUNTJAC	F	DOE	6	602 395	PLANTATION	AM
18-Jan-25	FALLOW	F	DOE	31	598 393	OLD QUARRY	PM
18-Jan-25	MUNTJAC	M	BUCK	6.5	606 397	MIDDLE HILL	PM
18-Jan-25	MUNTJAC	F	DOE	7	606 397	MIDDLE HILL	PM
19-Jan-25	FALLOW	M	PRICKET	27	596 389	OLD QUARRY	PM
21-Jan-25						TARRINGTON COMMON	PM
22-Jan-25						PLANTATION	PM
25-Jan-25						DEVERAUX PONDS	PM
25-Jan-25	MUNTJAC	M	BUCK	13	600 395	PUNCH BOWL	PM
25-Jan-25	MUNTJAC	F	DOE	8	603 385	THE CASTLE	PM
25-Jan-25	ROE	F	DOE	12	604 388	PRIORS WOOD	PM
26-Jan-25	MUNTJAC	F	DOE	8.5	604 390	LOST VALLEY	AM
26-Jan-25							AM
26-Jan-25	FALLOW	M	PRICKET	39	607 395	PLANTATION	AM
26-Jan-25	ROE	F	DOE	17	608 391	PLANTATION	AM
26-Jan-25	FALLOW	F	DOE	31	600 386	PRIORS WOOD	AM
26-Jan-25	FALLOW	F	DOE	30	606 383	PRIORS WOOD	AM
26-Jan-25	MUNTJAC	M	BUCK	5	615 376	DEVERAUX PONDS	AM
26-Jan-25	ROE	F	DOE	16	625 370	DEVERAUX PONDS	AM
27-Jan-25	FALLOW	F	DOE	27.5	605 392	PLANTATION	PM
27-Jan-25	MUNTJAC	F	DOE	7	603 393	PLANTATION	PM
27-Jan-25	FALLOW	M	BUCK	37	602 399	DEVERAUX PONDS	PM
27-Jan-25	MUNTJAC	M	BUCK	8	620 369	DEVERAUX PONDS	PM
30-Jan-25	FALLOW	M	PRICKET	35	606 387	PLANTATION	AM
31-Jan-25						PLANTATION	PM
31-Jan-25						DEVERAUX PONDS	PM
01-Feb-25	MUNTJAC	M	BUCK	10	604 399	LOST VALLEY	AM
02-Feb-25						STOKE EDITH FIELDS	AM
02-Feb-25	MUNTJAC	M	BUCK		611 397	SWILLOW WOOD	AM
02-Feb-25	FALLOW	M	PRICKET	30	609 398	SWILLOW WOOD	AM
02-Feb-25	FALLOW	M	FAWN	17	611 397	SWILLOW WOOD	AM
07-Feb-25	FALLOW	M	FAWN	22	609 385	LITTLE HILL	PM
07-Feb-25	MUNTJAC	F	DOE	1.5	599 393	OLD QUARRY	PM
07-Feb-25	FOX				598 394	OLD QUARRY	PM
08-Feb-25	MUNTJAC	M	BUCK	7	623 363	DEVERAUX PONDS	AM
08-Feb-25							PM
09-Feb-25							AM
09-Feb-25	MUNTJAC	F	DOE	8.5	601 398	PLANTATION	AM
09-Feb-25	FALLOW	F	DOE	30	599 401	STOKE EDITTH FIELDS	AM
09-Feb-25	FALLOW	F	DOE	33	599 401	STOKE EDITH FIELDS	AM
09-Feb-25	FALLOW	M	FAWN	16	601 385	PRIORS WOOD	AM
15-Feb-25	FALLOW	M	FAWN	19	591 391	TOWER HILL	PM
16-Feb-25						TOWER HILL	PM
16-Feb-25						LEANING TOWER	PM
16-Feb-25						TOWER HILL	AM
16-Feb-25						STOKE EDITH FIELDS	AM
21-Feb-25	FALLOW	F	DOE	32	589 390	KEEPERS COTTAGE	AM
21-Feb-25	FALLOW	M	FAWN	27	589 390	KEEPERS COTTAGE	AM
21-Feb-25	FALLOW	M	BUCK	42	623 363	DEVERAUX PONDS	AM
21-Feb-25	MUNTJAC	M	BUCK	7	618 395	TARRINGTON COMMON	PM
21-Feb-25	FALLOW	F	DOE	27	601 392	SPOOKY COTTAGE	PM
21-Feb-25	ROE	F	DOE	20	606 392	PLANTATION	PM
22-Feb-25	FALLOW	F	DOE	30.5	599 402	STOKE EDITH FIELDS	AM
22-Feb-25	FALLOW	F	FAWN	17	599 402	STOKE EDITH FIELDS	AM
22-Feb-25	FALLOW	M	FAWN	23	584 389	BACKBURY HILL	AM
22-Feb-25	MUNTJAC	M	BUCK	11	592 389	FRITH WOODS	AM
22-Feb-25	MUNTJAC	M	BUCK	8	623 366	DEVERAUX PONDS	AM
22-Feb-25	FOX		DOG		623 363	DEVERAUX PONDS	AM
24-Feb-25						DEVERAUX PONDS	PM
26-Feb-25						TOWER HILL	PM
28-Feb-25	FALLOW	M	YEARLING	25	604 396	PLANTATION	AM
28-Feb-25	FALLOW	F	YEARLING	18	619 385	COSSINGTON	PM
28-Feb-25	MUNTJAC	M	BUCK	9	609 391	MIDDLE HILL	PM
28-Feb-25	FALLOW	M	PRICKET	37	600 397	STALAG HIGHSEAT	PM
01-Mar-25	FALLOW	F	DOE	35	599 402	STOKE EDITH FIELDS	AM
01-Mar-25	MUNTJAC	F	DOE	8	609 385	LITTLE HILL	PM
02-Mar-25	FALLOW	F	DOE	37	618 389	SEAGER HILL 	AM
02-Mar-25	FALLOW	F	YEARLING	21	618 389	SEAGER HILL 	AM
02-Mar-25	FALLOW	F	YEARLING	19	618 389	SEAGER HILL 	AM
02-Mar-25	FALLOW	F	DOE	30			AM
02-Mar-25	FALLOW	F	DOE	29.5			AM
02-Mar-25	MUNTJAC	F	DOE	4			AM
02-Mar-25	FALLOW	M	YEARLING	20	599 402	STOKE EDITH FIELDS	PM
03-Mar-25						FRITH WOODS	PM
06-Mar-25							PM
07-Mar-25							PM
08-Mar-25						PLANTATION	AM
08-Mar-25						DEVERAUX PONDS	AM
13-Mar-25						DEVERAUX PONDS	PM
15-Mar-25						DEVERAUX PONDS	AM
15-Mar-25	FALLOW	F	YEARLING	24	607 394	PLANTATION	AM
15-Mar-25	MUNTJAC	M	BUCK	12	607 394	PLANTATION	AM
22-Mar-25	ROE	F	DOE	15	603 395	PLANTATION	PM
22-Mar-25	FALLOW	F	DOE	32	605 400	PLANTATION	PM
22-Mar-25	FALLOW	F	DOE	26	605 400	PLANTATION	PM
22-Mar-25	FALLOW	F	DOE	26	605 398	PLANTATION	PM
23-Mar-25						PLANTATION	PM
24-Mar-25						STOKE EDITH FIELDS	PM
24-Mar-25						DEVERAUX PONDS	PM
25-Mar-25	FALLOW	M	YEARLING	24	602 394	PLANTATION	PM
25-Mar-25	MUNTJAC	F	DOE	4	602 394	PLANTATION	PM
26-Mar-25	FALLOW	M	YEARLING	27	615 391	HIGHNAM FARM	PM
26-Mar-25	FALLOW	M	PRICKET	41	615 391	HIGHNAM FARM	PM
26-Mar-25						PLANTATION	PM
26-Mar-25						DEVERAUX PONDS	PM
28-Mar-25	FALLOW	F	DOE	26	591 391	TOWER HILL	AM
28-Mar-25	MUNTJAC	F	DOE	8.5	591 391	TOWER HILL	AM
28-Mar-25	FALLOW	M	YEARLING	21	612 396	SWILLOW WOOD	PM
28-Mar-25	ROE	F	DOE	15	605 385	JURASSIC RIDGE	PM
29-Mar-25	MUNTJAC	M	DOE	8	621 374	DEVERAUX PONDS	AM
29-Mar-25	FALLOW	F	DOE	27	621 374	DEVERAUX PONDS	AM
29-Mar-25	FALLOW	F	YEARLING	20	621 374	DEVERAUX PONDS	AM
30-Mar-25	FALLOW	M	YEARLING	23	623 371	DEVERAUX PONDS	AM
30-Mar-25							PM
30-Mar-25	FALLOW	F	DOE	24			PM
31-Mar-25	MUNTJAC	F	DOE	7	603 402	HIDDEN VALLEY	AM
31-Mar-25	FALLOW	F	DOE	34	601 385	PRIORS WOOD	PM
06-Apr-25						SWILLOW WOOD	AM
06-Apr-25	ROE	M	BUCK	16		PLANTATION	AM
14-Apr-25	FALLOW	M	YEARLING	23	609 396	STOKE EDITH FIELDS	PM
14-Apr-25							PM
17-Apr-25	FALLOW	M	YEARLING	25	618 373	DEVERAUX PONDS	AM
17-Apr-25	MUNTJAC	M	BUCK		621 373	DEVERAUX PONDS	AM
17-Apr-25	MUNTJAC	F	DOE		616 375	DEVERAUX PONDS	AM
18-Apr-25						SILO	PM
24-Apr-25						STOKE EDITH FIELDS	PM
26-Apr-25	MUNTJAC	F	DOE	10	608 382	LITTLE HILL	PM
26-Apr-25	MUNTJAC	F	DOE	2	608 382	LITTLE HILL	PM
26-Apr-25	MUNTJAC	F	DOE	12	610 387	MIDDLE HILL	PM
26-Apr-25	MUNTJAC	F	DOE	8	619 389	SEAGER HILL 	PM
26-Apr-25	MUNTJAC	M	BUCK	10	608 382	LITTLE HILL	PM
26-Apr-25	MUNTJAC	M	BUCK	9	607 398	PARK COTTAGE	PM
26-Apr-25	FALLOW	M	YEARLING	28	609 398	STOKE EDITH FIELDS	PM
27-Apr-25	FALLOW	M	PRICKET	44	619 397	TARRINGTON COMMON	PM
28-Apr-25						PARK FARM FIELD	PM
30-Apr-25	MUNTJAC	F	DOE	4	603 396	SILO	PM
01-May-25	MUNTJAC	F	DOE	9	597 390	PLANTATION	PM
01-May-25	MUNTJAC	M	BUCK	10	600 393	PLANTATION	PM
03-May-25	MUNTJAC	M	BUCK	4	608 384	MIDDLE HILL	AM
03-May-25	ROE	M	BUCK	20	608 389	PLANTATION	AM
03-May-25						PLANTATION	PM
03-May-25						The Oval farm	PM
03-May-25	MUNTJAC	F	DOE	5	608 384	MIDDLE HILL	PM
03-May-25	MUNTJAC	M	BUCK	6	607 385	LEANING TOWER	PM
04-May-25	MUNTJAC	F	DOE	5	619 386	COSSINGTON	AM
04-May-25	FALLOW	M	PRICKET	25	611 382	LITTLE HILL	AM
09-May-25	MUNTJAC	M	BUCK	11	599 394	PLANTATION	PM
11-May-25	MUNTJAC	F	DOE	8		LOST VALLEY	AM
11-May-25	MUNTJAC	F	DOE	7.5		LOST VALLEY	AM
10-May-25							AM
11-May-25	MUNTJAC	F	DOE	5	602 387	PRIORS WOOD	AM
23-May-25							PM
24-May-25							PM
26-May-25							PM
29-May-25	MUNTJAC	M	BUCK	10	6065 3922	PLANTATION	PM
01-Jun-25							PM
04-Jun-25						PLANTATION	PM
08-Jun-25	MUNTJAC	M	BUCK	11	608 383	NEIGHBROOKS	AM
08-Jun-25							AM
13-Jun-25							PM
21-Jun-25	MUNTJAC	M	BUCK	8	607 384	MIDDLE HILL	AM
21-Jun-25						PLANTATION	AM
22-Jun-25	FOX				605 388	GRALLOUCH STATION	PM
22-Jun-25	MUNTJAC	F	DOE 	7	603 397	SILO SEAT	PM
22-Jun-25						SPOOKY COTTAGE	PM
29-Jun-25						PLANTATION	PM
29-Jun-25						STOKE EDITH FIELDS	PM
29-Jun-25	MUNTJAC	M	BUCK	10	623 367	DEVERAUX PONDS	PM
01-Jul-25						PLANTATION	PM
06-Jul-25	FOX					MIDDLE HILL	PM
06-Jul-25	FOX					MIDDLE HILL	PM
06-Jul-25	FOX					MIDDLE HILL	PM
08-Jul-25	MUNTJAC	F	DOE	9	603 396	PLANTATION	PM
08-Jul-25	MUNTJAC	F	DOE	6	603 396	PLANTATION	PM
09-Jul-25	FOX					MIDDLE HILL	PM
09-Jul-25	FOX					MIDDLE HILL	PM
12-Jul-25						PLANTATION	AM
12-Jul-25						LOST VALLEY	AM
12-Jul-25	ROE	M	BUCK		617 382	PENTELOE POND	PM
12-Jul-25	FOX				604 400		PM
12-Jul-25	FOX				604 400		PM
12-Jul-25	FOX				604 400		PM
16-Jul-25	MUNTJAC	M	BUCK		603 395	PLANTATION	PM
16-Jul-25							PM
20-Jul-25	MUNTJAC	F	DOE		612 399	SWILLOW WOOD	PM
27-Jul-25	MUNTJAC	M	BUCK		600 401	PERTON PARK	AM
27-Jul-25	MUNTJAC	F	DOE		605 407	STOKE EDITH CHURCH	AM
31-Jul-25						TARRINGTON COMMON	PM
02-Aug-25						DEVERAUX PONDS	AM
04-Aug-25						STOKE EDITH FIELDS	PM
04-Aug-25	ROE	M	BUCK		609 390	SHEEPCOTE HILL	PM`;

function parseDate(dateStr: string): string {
  if (!dateStr || dateStr.trim() === '') return '';
  
  // Handle various date formats
  const cleanDate = dateStr.trim();
  
  // Handle formats like "30-Jul-24", "05-Oct", "25 Jam 25" (typo), etc.
  if (cleanDate.includes('-')) {
    const parts = cleanDate.split('-');
    if (parts.length === 3) {
      const [day, month, year] = parts;
      const monthMap: { [key: string]: string } = {
        'Jan': '01', 'Feb': '02', 'Mar': '03', 'Apr': '04',
        'May': '05', 'Jun': '06', 'Jul': '07', 'Aug': '08',
        'Sep': '09', 'Oct': '10', 'Nov': '11', 'Dec': '12',
        'Jam': '01' // Handle typo
      };
      
      const monthNum = monthMap[month] || '01';
      const fullYear = year.length === 2 ? `20${year}` : year;
      const paddedDay = day.padStart(2, '0');
      
      return `${fullYear}-${monthNum}-${paddedDay}`;
    }
  }
  
  return '2024-01-01'; // Default fallback
}

function normalizeSpecies(species: string): string {
  if (!species || species.trim() === '') return 'Unknown';
  
  const normalized = species.trim().toUpperCase();
  const speciesMap: { [key: string]: string } = {
    'MUNTJAC': 'Muntjac',
    'ROE': 'Roe Deer',
    'FALLOW': 'Fallow Deer',
    'FOX': 'Fox',
    'RED': 'Red Deer'
  };
  
  return speciesMap[normalized] || species;
}

function normalizeSex(sex: string): 'Male' | 'Female' | 'Unknown' {
  if (!sex || sex.trim() === '') return 'Unknown';
  
  const normalized = sex.trim().toUpperCase();
  if (normalized === 'M' || normalized === 'MALE') return 'Male';
  if (normalized === 'F' || normalized === 'FEMALE') return 'Female';
  return 'Unknown';
}

function normalizeMaturity(maturity: string): 'Adult' | 'Juvenile' | 'Unknown' {
  if (!maturity || maturity.trim() === '') return 'Unknown';
  
  const normalized = maturity.trim().toUpperCase();
  const adultTerms = ['DOE', 'BUCK', 'VIXEN', 'DOG', 'SORREL', 'YEARLING'];
  const juvenileTerms = ['FAWN', 'PRICKET'];
  
  if (adultTerms.includes(normalized)) return 'Adult';
  if (juvenileTerms.includes(normalized)) return 'Juvenile';
  return 'Unknown';
}

function normalizeTimeOfDay(timeStr: string): 'Dawn' | 'Morning' | 'Afternoon' | 'Dusk' | 'Night' {
  if (!timeStr || timeStr.trim() === '') return 'Morning';
  
  const normalized = timeStr.trim().toUpperCase();
  if (normalized === 'AM') return 'Morning';
  if (normalized === 'PM') return 'Afternoon';
  return 'Morning';
}

function normalizeGridRef(gridRef: string): string {
  if (!gridRef || gridRef.trim() === '') return '';
  
  // Clean up grid reference - add SO prefix if missing
  let cleaned = gridRef.trim();
  
  // If it's just numbers, assume it's SO grid
  if (/^\d+\s+\d+$/.test(cleaned)) {
    cleaned = `SO ${cleaned}`;
  }
  
  // Handle malformed entries like "6065 3922" -> "SO 606 392"
  if (/^\d{4}\s+\d{4}$/.test(cleaned)) {
    const parts = cleaned.split(/\s+/);
    const easting = parts[0].substring(0, 3);
    const northing = parts[1].substring(0, 3);
    cleaned = `SO ${easting} ${northing}`;
  }
  
  // Handle entries like "307 643" which seem to be typos
  if (cleaned.includes('307 643')) {
    cleaned = 'SO 620 369'; // Use a nearby valid reference
  }
  
  return cleaned;
}

export function seedDatabase(): number {
  const db = getDatabase();
  let insertedCount = 0;

  const lines = rawData.split('\n').filter(line => line.trim());

  for (const line of lines) {
    const columns = line.split('\t');

    // Skip lines that don't have enough data or are just location entries
    if (columns.length < 3) continue;

    const [dateStr, species, sex, maturity, weightStr, gridRef, location, timeOfDay] = columns;

    // Skip entries that are just location visits without species data
    if (!species || species.trim() === '') continue;

    const parsedDate = parseDate(dateStr);
    const normalizedSpecies = normalizeSpecies(species);
    const normalizedSex = normalizeSex(sex);
    const normalizedMaturity = normalizeMaturity(maturity);
    const weight = weightStr && weightStr.trim() !== '' ? parseFloat(weightStr.replace('!', '')) || 0 : 0;
    const normalizedGridRef = normalizeGridRef(gridRef);
    const normalizedLocation = location && location.trim() !== '' ? location.trim() : 'Unknown Location';
    const normalizedTimeOfDay = normalizeTimeOfDay(timeOfDay);

    // Skip if we don't have essential data
    if (!parsedDate || normalizedSpecies === 'Unknown') continue;

    const record: Omit<DeerStalkingRecord, 'id' | 'createdAt' | 'updatedAt'> = {
      date: parsedDate,
      species: normalizedSpecies,
      sex: normalizedSex,
      maturity: normalizedMaturity,
      weight: weight,
      gridRef: normalizedGridRef,
      location: normalizedLocation,
      shooter: 'Field Data', // Default shooter name since not provided
      timeOfDay: normalizedTimeOfDay,
      remarks: '', // No remarks in the source data
    };

    try {
      db.insertRecord(record);
      insertedCount++;
    } catch (error) {
      console.error('Error inserting record:', error, record);
    }
  }

  return insertedCount;
}

// Function to import data from the 2stalk.csv file
export async function importFromCSVFile(): Promise<{ imported: number; skipped: number; errors: number }> {
  try {
    // Read the CSV file content
    const response = await fetch('/2stalk.csv');
    if (!response.ok) {
      throw new Error('Could not load CSV file');
    }

    const csvContent = await response.text();
    const result = importCSVData(csvContent);

    console.log(`CSV Import completed: ${result.imported} imported, ${result.skipped} skipped, ${result.errors} errors`);
    return result;
  } catch (error) {
    console.error('Error importing CSV file:', error);
    return { imported: 0, skipped: 0, errors: 1 };
  }
}

// Function to manually trigger CSV import (for development/testing)
export function triggerCSVImport(): void {
  importFromCSVFile().then(result => {
    console.log('CSV import result:', result);
    // Optionally reload the page or update the UI
    if (result.imported > 0) {
      console.log(`Successfully imported ${result.imported} new records!`);
    }
  });
}
